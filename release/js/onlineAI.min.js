(function(){var k,n=this;
function aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function p(a){return"string"==typeof a}var r="closure_uid_"+(1E9*Math.random()>>>0),ba=0;function ca(a){var b=aa(a);if("object"==b||"array"==b){if(a.Ib)return a.Ib();var b="array"==b?[]:{},c;for(c in a)b[c]=ca(a[c]);return b}return a}function da(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};function ea(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function fa(a){var b=p(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};var s=Array.prototype,ga=s.indexOf?function(a,b,c){return s.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ha=s.filter?function(a,b,c){return s.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=p(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var l=g[h];b.call(c,l,h,a)&&(e[f++]=l)}return e};function ia(a,b){var c=ga(a,b);0<=c&&s.splice.call(a,c,1)}
function ja(a,b,c){return 2>=arguments.length?s.slice.call(a,b):s.slice.call(a,b,c)};var t,ka,la,ma;function na(){return n.navigator?n.navigator.userAgent:null}ma=la=ka=t=!1;var oa;if(oa=na()){var pa=n.navigator;t=0==oa.lastIndexOf("Opera",0);ka=!t&&(-1!=oa.indexOf("MSIE")||-1!=oa.indexOf("Trident"));la=!t&&-1!=oa.indexOf("WebKit");ma=!t&&!la&&!ka&&"Gecko"==pa.product}var qa=t,v=ka,x=ma,A=la,ra=n.navigator,sa=-1!=(ra&&ra.platform||"").indexOf("Mac");function ta(){var a=n.document;return a?a.documentMode:void 0}var ua;
a:{var va="",wa;if(qa&&n.opera)var xa=n.opera.version,va="function"==typeof xa?xa():xa;else if(x?wa=/rv\:([^\);]+)(\)|;)/:v?wa=/\b(?:MSIE|rv)\s+([^\);]+)(\)|;)/:A&&(wa=/WebKit\/(\S+)/),wa)var ya=wa.exec(na()),va=ya?ya[1]:"";if(v){var za=ta();if(za>parseFloat(va)){ua=String(za);break a}}ua=va}var Aa={};
function C(a){var b;if(!(b=Aa[a])){b=0;for(var c=String(ua).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),q=RegExp("(\\d*)(\\D*)","g");do{var y=l.exec(g)||["","",""],z=q.exec(h)||["","",""];if(0==y[0].length&&0==z[0].length)break;b=((0==y[1].length?0:parseInt(y[1],10))<(0==z[1].length?0:parseInt(z[1],10))?-1:(0==y[1].length?0:parseInt(y[1],
10))>(0==z[1].length?0:parseInt(z[1],10))?1:0)||((0==y[2].length)<(0==z[2].length)?-1:(0==y[2].length)>(0==z[2].length)?1:0)||(y[2]<z[2]?-1:y[2]>z[2]?1:0)}while(0==b)}b=Aa[a]=0<=b}return b}var Ba=n.document,Ca=Ba&&v?ta()||("CSS1Compat"==Ba.compatMode?parseInt(ua,10):5):void 0;!x&&!v||v&&v&&9<=Ca||x&&C("1.9.1");var Da=v&&!C("9");function Ea(a){a=a.className;return p(a)&&a.match(/\S+/g)||[]}function D(a,b){for(var c=Ea(a),d=ja(arguments,1),e=c,f=0;f<d.length;f++)0<=ga(e,d[f])||e.push(d[f]);a.className=c.join(" ")}function E(a,b){var c=Ea(a),d=ja(arguments,1),c=Fa(c,d);a.className=c.join(" ")}function Fa(a,b){return ha(a,function(a){return!(0<=ga(b,a))})}function F(a,b){var c=Ea(a);return 0<=ga(c,b)};function G(a,b){var c=b||document;return c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Ga(a,b)}function I(a,b){var c=b||document,d=null;return(d=c.querySelectorAll&&c.querySelector?c.querySelector("."+a):G(a,b)[0])||null}
function Ga(a,b){var c,d,e,f;c=document;c=b||c;if(c.querySelectorAll&&c.querySelector&&a)return c.querySelectorAll(""+(a?"."+a:""));if(a&&c.getElementsByClassName){var g=c.getElementsByClassName(a);return g}g=c.getElementsByTagName("*");if(a){f={};for(d=e=0;c=g[d];d++){var h=c.className;"function"==typeof h.split&&0<=ga(h.split(/\s+/),a)&&(f[e++]=c)}f.length=e;return f}return g}function K(a){return document.createElement(a)}
function N(a){var b=document,c=b.createElement("div");v?(c.innerHTML="\x3cbr\x3e"+a,c.removeChild(c.firstChild)):c.innerHTML=a;if(1==c.childNodes.length)return c.removeChild(c.firstChild);for(a=b.createDocumentFragment();c.firstChild;)a.appendChild(c.firstChild);return a}function Ha(a,b){a.appendChild(b)}function O(a){return a&&a.parentNode?a.parentNode.removeChild(a):null}
function P(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild((9==a.nodeType?a:a.ownerDocument||a.document).createTextNode(String(b)))}}var Ia={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},Ka={IMG:" ",BR:"\n"};
function Q(a){if(Da&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];La(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Da||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""));return a}
function La(a,b,c){if(!(a.nodeName in Ia))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in Ka)b.push(Ka[a.nodeName]);else for(a=a.firstChild;a;)La(a,b,c),a=a.nextSibling};var Ma=!v||v&&9<=Ca,Na=v&&!C("9");!A||C("528");x&&C("1.9b")||v&&C("8")||qa&&C("9.5")||A&&C("528");x&&!C("8")||v&&C("9");function Oa(a,b){this.type=a;this.currentTarget=this.target=b}k=Oa.prototype;k.Va=!1;k.defaultPrevented=!1;k.Yb=!0;k.stopPropagation=function(){this.Va=!0};k.preventDefault=function(){this.defaultPrevented=!0;this.Yb=!1};function Pa(a){Pa[" "](a);return a}Pa[" "]=function(){};function T(a,b){a&&this.ma(a,b)}(function(){function a(){}a.prototype=Oa.prototype;T.ub=Oa.prototype;T.prototype=new a})();k=T.prototype;k.target=null;k.relatedTarget=null;k.offsetX=0;k.offsetY=0;k.clientX=0;k.clientY=0;k.screenX=0;k.screenY=0;k.button=0;k.keyCode=0;k.charCode=0;k.ctrlKey=!1;k.altKey=!1;k.shiftKey=!1;k.metaKey=!1;k.Wb=!1;k.M=null;
k.ma=function(a,b){var c=this.type=a.type;Oa.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(x){var e;a:{try{Pa(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=A||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=A||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:
a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Wb=sa?a.metaKey:a.ctrlKey;this.state=a.state;this.M=a;a.defaultPrevented&&this.preventDefault();delete this.Va};k.stopPropagation=function(){T.ub.stopPropagation.call(this);this.M.stopPropagation?this.M.stopPropagation():this.M.cancelBubble=!0};
k.preventDefault=function(){T.ub.preventDefault.call(this);var a=this.M;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Na)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Qa="closure_listenable_"+(1E6*Math.random()|0),Ra=0;function Sa(a,b,c,d,e,f){this.ya=a;this.rb=b;this.src=c;this.type=d;this.capture=!!e;this.cb=f;this.key=++Ra;this.Ma=this.$a=!1};var Ta={},U={},V={},Ua={};
function X(a,b,c,d,e){if("array"==aa(b))for(var f=0;f<b.length;f++)X(a,b[f],c,d,e);else if(c=Va(c),a&&a[Qa])a.ec(b,c,d,e);else a:{if(!b)throw Error("Invalid event type");d=!!d;var g=U;b in g||(g[b]={ca:0});g=g[b];d in g||(g[d]={ca:0},g.ca++);var g=g[d],f=a[r]||(a[r]=++ba),h;if(g[f]){h=g[f];for(var l=0;l<h.length;l++)if(g=h[l],g.ya==c&&g.cb==e){if(g.Ma)break;h[l].$a=!1;break a}}else h=g[f]=[],g.ca++;l=Wa();g=new Sa(c,l,a,b,d,e);g.$a=!1;l.src=a;l.ya=g;h.push(g);V[f]||(V[f]=[]);V[f].push(g);a.addEventListener?
a.addEventListener(b,l,d):a.attachEvent(b in Ua?Ua[b]:Ua[b]="on"+b,l);Ta[g.key]=g}}function Wa(){var a=Xa,b=Ma?function(c){return a.call(b.src,b.ya,c)}:function(c){c=a.call(b.src,b.ya,c);if(!c)return c};return b}function Ya(a,b,c){var d=1;b=b[r]||(b[r]=++ba);if(a[b]){a=a[b];b=a.length;if(0<b){for(var e=Array(b),f=0;f<b;f++)e[f]=a[f];a=e}else a=[];for(b=0;b<a.length;b++)(e=a[b])&&!e.Ma&&(d&=!1!==Za(e,c))}return Boolean(d)}
function Za(a,b){var c=a.ya,d=a.cb||a.src;if(a.$a&&"number"!=typeof a&&a&&!a.Ma){var e=a.src;if(e&&e[Qa])e.fc(a);else{var f=a.type,g=a.rb,h=a.capture;e.removeEventListener?e.removeEventListener(f,g,h):e.detachEvent&&e.detachEvent(f in Ua?Ua[f]:Ua[f]="on"+f,g);e=e[r]||(e[r]=++ba);V[e]&&(g=V[e],ia(g,a),0==g.length&&delete V[e]);a.Ma=!0;a.ya=null;a.rb=null;a.src=null;a.cb=null;if(g=U[f][h][e])ia(g,a),0==g.length&&(delete U[f][h][e],U[f][h].ca--),0==U[f][h].ca&&(delete U[f][h],U[f].ca--),0==U[f].ca&&
delete U[f];delete Ta[a.key]}}return c.call(d,b)}
function Xa(a,b){if(a.Ma)return!0;var c=a.type,d=U;if(!(c in d))return!0;var d=d[c],e,f;if(!Ma){if(!(c=b))a:{for(var c=["window","event"],g=n;e=c.shift();)if(null!=g[e])g=g[e];else{c=null;break a}c=g}e=c;c=!0 in d;g=!1 in d;if(c){if(0>e.keyCode||void 0!=e.returnValue)return!0;a:{var h=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(l){h=!0}if(h||void 0==e.returnValue)e.returnValue=!0}}h=new T;h.ma(e,this);e=!0;try{if(c){for(var q=[],y=h.currentTarget;y;y=y.parentNode)q.push(y);f=d[!0];for(var z=
q.length-1;!h.Va&&0<=z;z--)h.currentTarget=q[z],e&=Ya(f,q[z],h);if(g)for(f=d[!1],z=0;!h.Va&&z<q.length;z++)h.currentTarget=q[z],e&=Ya(f,q[z],h)}else e=Za(a,h)}finally{q&&(q.length=0)}return e}d=new T(b,this);return e=Za(a,d)}var $a="__closure_events_fn_"+(1E9*Math.random()>>>0);function Va(a){return"function"==aa(a)?a:a[$a]||(a[$a]=function(b){return a.handleEvent(b)})};function Y(a,b,c){if(p(b))ab(a,c,b);else{a=da(ab,a);for(var d in b)a.call(void 0,b[d],d,b)}}function ab(a,b,c){(c=bb(a,c))&&(a.style[c]=b)}function bb(a,b){var c=ea(b);if(void 0===a.style[c]){var d=(A?"Webkit":x?"Moz":v?"ms":qa?"O":null)+fa(b);if(void 0!==a.style[d])return d}return c}function cb(a,b){var c=a.style[ea(b)];return"undefined"!==typeof c?c:a.style[bb(a,b)]||""};function db(a){return a?{s:a.src,w:a.width,h:a.height}:null}function eb(a){if(a){var b=new Image;b.src=a.s;b.width=a.w;b.height=a.h;return b}return null}function fb(a){return{width:a.w,height:a.h,src:a.s,ib:a.x,jb:a.y,name:a.n,index:a.i}}var Z={P:"posX",Q:"posY",dir:"dir",speed:"speed",wb:"visiable",status:"status",mb:"belong",G:"others","\u6a2a\u5750\u6807":"posX","\u7eb5\u5750\u6807":"posY","\u65b9\u5411":"dir","\u901f\u5ea6":"speed","\u53ef\u7a7f\u900f":"visiable","\u72b6\u6001":"status","\u5c5e\u4e8e":"belong"};
function gb(a,b){return{o:a,n:b}}function hb(a,b,c,d,e){return{x:a,y:b,l:c,a:d,i:e}}function ib(a){return{Ia:a.ej,Ha:a.ea,Y:a.em,Sa:a.mc,name:a.nm,type:a.ty}}function jb(a){return{k:a.fn,N:a.fa,hb:a.op,Na:a.sn,F:a.sa,Ta:a.lo}}function kb(a){return{action:a.ac,k:a.fn,N:a.fa,Na:a.sn,F:a.sa}}function lb(a){return{rotate:a.r,vb:a.t,lb:a.s}}function mb(a){return{j:a.n,links:a.l,name:a.m,type:a.t}}function nb(a){return{left:a.l,top:a.t,type:a.y,index:a.i,H:a.v}};function ob(a){this.L=a}k=ob.prototype;k.L=null;k.S=null;k.setData=function(a){this.L=a};k.getData=function(){return this.L};k.setAttribute=function(a,b){Z[a]&&(a=Z[a]);var c=!1,d;for(d in Z)if(Z[d]==a){this.S[a]=b;c=!0;break}c||(this.S[Z.G][a]=b)};k.getAttribute=function(a){Z[a]&&(a=Z[a]);return null!=this.S[a]&&void 0!=this.S[a]?this.S[a]:null!=this.S[Z.G][a]&&void 0!=this.S[Z.G][a]?this.S[Z.G][a]:null};function pb(a,b){this.L=a;this.$={};this.V={};b&&(this.Vb=b);var c=this.L.S,d;for(d in c)if(this.V[d]=-1,d==Z.G){this.V[d]={};for(var e in c[d])this.V[d][e]=-1}}k=pb.prototype;k.L=null;k.$=null;k.V=null;k.Vb=null;k.setAttribute=function(a,b){Z[a]&&(a=Z[a]);var c=!1,d;for(d in Z)if(Z[d]==a){this.$[a]=b;this.V[a]=1;c=!0;break}c||(this.$[Z.G]||(this.$[Z.G]={}),this.V[Z.G]||(this.V[Z.G]={}),this.$[Z.G][a]=b,this.V[Z.G][a]=1)};
k.getAttribute=function(a){Z[a]&&(a=Z[a]);return 1==this.V[a]?this.$[a]:this.V[Z.G]&&1==this.V[Z.G][a]?this.$[Z.G][a]:this.L.getAttribute(a)};k.getName=function(){return this.L.getData().name?this.L.getData().name:fb(this.L.getData()).name};function $(a,b,c){function d(){if(h){var a=h.getAttribute(Z.P),b=h.getAttribute(Z.Q),c=!1;a-e>q?(a-=q,c=!0):e-a>q&&(a+=q,c=!0);b-f>q?(b-=q,c=!0):f-b>q&&(b+=q,c=!0);c?(h.setAttribute(Z.P,a),h.setAttribute(Z.Q,b),window.setTimeout(function(){d()},30)):(h.setAttribute(Z.P,e),h.setAttribute(Z.Q,f),h.setAttribute(Z.status,l))}}var e=a.getAttribute(Z.P),f=a.getAttribute(Z.Q),g=a.getAttribute(Z.speed);c&&a.setAttribute(Z.dir,c);c=a.getAttribute(Z.dir);var h=b[f][e];b[f][e]=null;var e=parseInt(e),f=parseInt(f),
l=a.getAttribute(Z.status),g=parseInt(g);switch(c){case "\u4e0a":f-=1;break;case "\u4e0b":f+=1;break;case "\u5de6":e-=1;break;case "\u53f3":e+=1}b[f][e]=h;b[f][e].setAttribute(Z.status,"moving");var q=0.05*g;d()}function qb(a,b,c){if(null!=a&&void 0!=a){var d=a.getAttribute(b);window.isNaN(parseInt(d))||window.isNaN(parseInt(c))||(d=parseInt(d)+parseInt(c),a.setAttribute(b,d))}}
function rb(a,b,c){if(null!=a&&void 0!=a){var d=a.getAttribute(b);window.isNaN(parseInt(d))||window.isNaN(parseInt(c))||(d=parseInt(d)-parseInt(c),a.setAttribute(b,d))}};v&&C(8);function sb(){return'\x3cdiv class\x3d"editbox"\x3e\x3cselect class\x3d"editboxselect"\x3e\x3c/select\x3e\x3cinput type\x3d"text" class\x3d"editboxinput" /\x3e\x3c/div\x3e'};function ub(){this.ma();this.d.oa=I("workflowList");this.d.Oa=I("workflowPart");this.d.pa=G("wfp",this.d.Oa);this.d.Xb=I("wfpRemove",this.d.Oa);this.d.Da=I("workflowspace");this.d.W=I("cellName");this.d.X=I("chooseType");this.d.da=I("eventList");this.d.C=I("workflowCanvas");var a=this.d;X(a.pa[0],"click",this.Fa,!1,this);X(a.pa[1],"click",this.Fa,!1,this);X(a.pa[2],"click",this.Fa,!1,this);X(a.pa[3],"click",this.Fa,!1,this)}k=ub.prototype;k.d=null;k.qa=null;k.ha=null;k.Ya=null;k.Ca=null;k.va=null;
k.O=null;k.ga=null;k.ma=function(){this.d={};this.qa=[];this.O={};this.ga=this.Ya=this.ha=0;this.Ca=!1};
k.Fa=function(a,b,c){a&&(a=a.M,a=a.target||a.srcElement);var d=K("div");D(d,"part");var e=K("p");D(e,"up");D(e,"pp");P(e,"+");var f=K("p");D(f,"left");D(f,"pp");P(f,"+");var g=K("p");D(g,"right");D(g,"pp");P(g,"+");var h=K("p");D(h,"down");D(h,"pp");P(h,"+");d.appendChild(e);d.appendChild(f);if(a==this.d.pa[2]||"jPart"==b)D(d,"jPart"),b=vb(this),d.appendChild(b),wb(this,e,f,g,h);else if(a==this.d.pa[0]||"sePart"==b)D(d,"sePart"),b=N('\x3cselect class\x3d"startAndEnd"\x3e\x3coption\x3e\u5f00\u59cb\x3c/option\x3e\x3coption\x3e\u7ed3\u675f\x3c/option\x3e\x3c/select\x3e'),
D(b,"sel"),d.appendChild(b),wb(this,e,f,g,h);else if(a==this.d.pa[1]||"ioPart"==b)D(d,"ioPart",1),wb(this,e,f,g,h);else if(a==this.d.pa[3]||"sPart"==b)D(d,"sPart"),b=vb(this),d.appendChild(b),wb(this,e,f,g,h);d.appendChild(g);d.appendChild(h);a||(this.ga=c);d.D=this.ga;e.D=10*this.ga+0;f.D=10*this.ga+1;g.D=10*this.ga+2;h.D=10*this.ga+3;++this.ga;this.d.Da.appendChild(d);xb(this,d);return d};
function wb(a,b,c,d,e){function f(b){b=b.M;b=b.target||b.srcElement;a.Ca?(b!=a.va&&b.parentNode!=a.va.parentNode?a.O[a.va.D]=[a.va,b]:b==a.va&&(a.O[a.va.D]=null),a.Ca=!1):(a.va=b,a.Ca=!0);a.xa()}X(b,"click",function(a){f(a)},!1,a);X(c,"click",function(a){f(a)},!1,a);X(d,"click",function(a){f(a)},!1,a);X(e,"click",function(a){f(a)},!1,a)}
function xb(a,b){var c=!1,d=0,e=0;X(b,"mousedown",function(f){if(a.d.Xb.checked){for(var g in this.O)this.O[g]&&(f=Math.floor(this.O[g][1].D/10),Math.floor(this.O[g][0].D/10)==b.D||f==b.D)&&(this.O[g]=null);O(b);a.xa();return!1}c=!0;f=f.M;g=f.y;d=f.x-parseInt(window.getComputedStyle(b)["margin-left"].split("px")[0]);e=g-parseInt(window.getComputedStyle(b)["margin-top"].split("px")[0])},!1,a);X(b,"mousemove",function(f){if(!c)return!1;f=f.M;f.preventDefault();5<=f.y-e&&550>=f.y-e&&Y(b,"margin-top",
f.y-e+"px");30<=f.x-d&&690>=f.x-d&&Y(b,"margin-left",f.x-d+"px");a.xa();return!1},!1,a);X(b,"mouseup",function(a){a=a.M;a.preventDefault();return c=!1},!1,a)}function vb(a){var b=K("select");D(b,"actionList");D(b,"sel");for(var c=G("me",a.d.da),d=0,e=c.length;d<e;++d){var f=K("option");P(f,Q(c[d]));D(f,"new");D(f,"judge");b.appendChild(f)}c=G("me",a.d.oa);d=1;for(e=c.length;d<e;++d)f=K("option"),P(f,Q(c[d])),D(f,"new"),D(f,"workflow"),b.appendChild(f);X(b,"mousedown",a.Gb,!1,a);return b}
k.Gb=function(a){a=a.M;a=a.target||a.srcElement;for(var b=a.options.selectedIndex,c=a.options.length-1;0<=c;--c)F(a.options[c],"new")&&O(a.options[c]);for(var d=G("me",this.d.da),c=0,e=d.length;c<e;++c){var f=K("option");P(f,Q(d[c]));D(f,"new");D(f,"judge");a.appendChild(f)}d=G("me",this.d.oa);c=1;for(e=d.length;c<e;++c)f=K("option"),P(f,Q(d[c])),D(f,"new"),D(f,"workflow"),a.appendChild(f);a.options.selectedIndex=b};
k.xa=function(){var a=this.d.C.getContext("2d");a.clearRect(0,0,800,600);var b=this.d.C.getBoundingClientRect().left-5,c=this.d.C.getBoundingClientRect().top,d;for(d in this.O)if(null!=this.O[d]){var e=this.O[d][0].getBoundingClientRect(),f=this.O[d][1].getBoundingClientRect(),g=e.left-b,e=e.top-c,h=f.left-b,f=f.top-c;a.beginPath();a.moveTo(g,e);a.lineTo(h,f);a.fillStyle="#FF0000";a.stroke();a.beginPath();a.arc(h,f,7,0,2*Math.PI,!0);a.closePath();a.fill()}};
k.eb=function(){var a=""!=this.d.W.value?this.d.W.value:"\u7a7a",b=this.d.X.options.selectedIndex;-1!=b&&(b=this.d.X.options[b].value);for(var c=G("part",this.d.Da),d=[],e=0,f=c.length;e<f;++e){var g=cb(c[e],"margin-left"),h=cb(c[e],"margin-top"),l=I("sel",c[e]),q=l.options.selectedIndex,l=-1!=q?l.options[q].value:"",q=Ea(c[e])[1];d.push({l:g,t:h,y:q,i:c[e].D,v:l})}var c=[],y;for(y in this.O)this.O[y]&&c.push([this.O[y][0].D,this.O[y][1].D]);y=G("me",this.d.oa);this.qa[this.ha]?(this.qa[this.ha]=
{n:d,l:c,m:a,t:b},P(y[this.ha],a)):(this.qa[this.ha]={n:d,l:c,m:a,t:b},b=K("li"),P(b,a),D(b,"me"),b.D=this.ha,this.d.oa.appendChild(b),X(b,"click",this.ta,!1,this),++this.Ya)};k.ka=function(a,b){for(var c=0,d=a.options.length;c<d;++c)if(a.options[c].value==b){a.options.selectedIndex=c;break}};
k.ta=function(a){this.clear();a=a.M;a=a.target||a.srcElement;this.ha=a.D;this.Ca=!1;a=mb(this.qa[this.ha]);this.d.W.value=a.name;this.ka(this.d.X,a.type);for(var b=0,c={},d=0,e=a.j.length;d<e;++d){var f=nb(a.j[d]);f.index>b&&(b=f.index);var g=this.Fa(null,f.type,f.index);Y(g,"margin-left",f.left);Y(g,"margin-top",f.top);this.ka(I("sel",g),f.H);c[f.index]=g}this.ga=++b;d=0;for(e=a.links.length;d<e;++d){var b=Math.floor(parseInt(a.links[d][0])%10),h=Math.floor(parseInt(a.links[d][1])/10),f=Math.floor(parseInt(a.links[d][1])%
10),g=G("pp",c[Math.floor(parseInt(a.links[d][0])/10)]),h=G("pp",c[h]);this.O[parseInt(a.links[d][0])]=[g[b],h[f]]}this.xa()};k.clear=function(){this.ha=this.Ya;this.d.C.getContext("2d").clearRect(0,0,800,600);for(var a=G("part",this.d.Da),b=a.length-1;0<=b;--b)O(a[b]);this.Ca=!1;this.O={};this.ga=0};function yb(a,b,c,d,e,f,g){this.R=a;this.A=ca(b);this.J=c;this.g=ca(d);this.q=ca(e);this.B=ca(f);this.C=g;this.Wa=!1;e={};a=0;for(b=this.q.length;a<b;++a){this.q[a]=ib(this.q[a]);c=0;for(d=this.q[a].Ia.length;c<d;++c)this.q[a].Ia[c]=jb(this.q[a].Ia[c]);c=0;for(d=this.q[a].Ha.length;c<d;++c)this.q[a].Ha[c]=kb(this.q[a].Ha[c]);g=f=0;this.q[a].Sa=lb(this.q[a].Sa);c=0;for(d=this.q[a].Y.length;c<d;++c){this.q[a].Y[c]={Ba:this.q[a].Y[c].p,status:this.q[a].Y[c].s};var h=this.q[a].Y[c].Ba,l=Math.floor(parseInt(h)%
this.R[0]),h=Math.floor(parseInt(h)/this.R[0]);0>=c&&(f=l,g=h);this.q[a].Y[c].Ba=!1==this.q[a].Sa.lb?[l-f,h-g]:[l,h]}e[this.q[a].name]=this.q[a]}this.q=e;e={};a=0;for(b=this.B.length;a<b;++a){this.B[a]=mb(this.B[a]);this.B[a].tb=-1;this.B[a].ob=-1;f={};c=0;for(d=this.B[a].j.length;c<d;++c)g=this.B[a].j[c],g=nb(g),f[g.index]=g,"sePart"==g.type&&("\u5f00\u59cb"==g.H?this.B[a].tb=g.index:this.B[a].ob=g.index);this.B[a].j=f;f={};c=0;for(d=this.B[a].links.length;c<d;++c){var q=this.B[a].links[c];g=Math.floor(parseInt(q[0])/
10);l=Math.floor(parseInt(q[0])%10);h=Math.floor(parseInt(q[1])/10);q=Math.floor(parseInt(q[1])%10);!f[g]&&(f[g]=[]);f[g].push([l,h,q])}this.B[a].links=f;e[this.B[a].name]=this.B[a];0==a&&(e.Rb=this.B[a].name)}this.B=e;c={};a=0;for(b=this.A.length;a<b;++a)d=fb(this.A[a].getData()),d.src=eb(d.src),this.A[a].setData(d),c[this.A[a].getData().name]=this.A[a];this.A=c;c=0;for(d=this.g.length;c<d;++c)for(a=0,b=this.g[c].length;a<b;++a)this.g[c][a]&&(e=this.A[this.g[c][a].getName()],this.g[c][a].L=e)}
k=yb.prototype;k.R=null;k.A=null;k.J=null;k.g=null;k.q=null;k.B=null;k.C=null;k.Qa=null;k.Wa=null;function zb(a){a.Wa=!1;a.Qa=window.setInterval(function(){a.xa()},40);Ab(a,a.B.Rb)}k.stop=function(){this.Qa&&window.clearInterval(this.Qa);this.Wa=!0};
function Ab(a,b){function c(){if(!a.Wa){e=d.links[f.index];switch(f.type){case "sePart":for(var b=0,l=e.length;b<l;){e=e[b][1];break}f=d.j[e];break;case "jPart":g=a.B[f.H]?Ab(a,f.H):a.q[f.H]?Bb(a,f.H,!1):[!1,null];b=0;for(l=e.length;b<l;++b)if(g[0]){if(3==e[b][0]){e=e[b][1];break}}else if(3!=e[b][0]){e=e[b][1];break}f=d.j[e];break;case "sPart":g=a.B[f.H]?Ab(a,f.H):a.q[f.H]?Bb(a,f.H,!0):[5<10*Math.random()?!0:!1,null];b=0;for(l=e.length;b<l;){e=e[b][1];break}f=d.j[e]}f.index!=d.ob&&window.setTimeout(function(){c()},
5)}}var d=a.B[b],e=d.tb,f=d.j[e],g=null;c();return g}
function Bb(a,b,c){b=a.q[b];var d=null,e=null;do{for(var d=a,e=b.Ia,f=b,g={x:-1,y:-1,qb:null},h={I:!0,H:null},l=null,q=e[0],y=!1,z=!1,w="\u5f62\u72b6"!=q.N&&"\u4efb\u610f"!=q.k&&"\u540c\u4e00"!=q.k,L=0,W=d.g.length;L<W&&!z&&!w;++L)for(var H=0,u=d.g[L].length;H<u&&!z;++H)if(g={x:-1,y:-1,qb:null},h={I:!0,H:null},"\u5f62\u72b6"==q.N){for(var l=y=!0,m="",R=-1,tb=-1,M=0,Ja=f.Y.length;M<Ja;++M){var B=H+f.Y[M].Ba[0],J=L+f.Y[M].Ba[1];if(!(0<=B&&B<d.R[0]&&0<=J&&J<d.R[1])){l=!1;break}if(!d.g[J][B]){l=!1;break}0>=
M&&(m=d.g[J][B].getName(),R=B,tb=J);switch(q.k){case "\u4efb\u610f":case "":break;case "\u540c\u4e00":l=d.g[J][B].getName()==m;break;default:l=d.g[J][B].getName()==q.k}if(!l)break;g.x=B;g.y=J;B=1;for(J=e.length;B<J&&l;++B){var l=e[B],S="\u5e76\u4e14";1<=B&&(S=e[B-1].Ta);Cb(d,l,g,h,S);l=h.I}}if(l){g.x=R;g.y=tb;z=l;break}}else{g.x=H;g.y=L;l=!0;B=0;for(J=e.length;B<J&&l;++B)l=e[B],S="\u5e76\u4e14",1<=B&&(S=e[B-1].Ta),Cb(d,l,g,h,S),(l=h.I)&&(y=!0);if(l){z=l;break}}if(!y){g={x:-1,y:-1,qb:null};h={I:!0,
H:null};l=!0;M=0;for(Ja=e.length&&l;M<Ja;++M)l=e[M],S="\u5e76\u4e14",1<=M&&(S=e[M-1].Ta),Cb(d,l,g,h,S),l=h.I;z=l}d={I:z,j:g,result:h};if(d.I&&c){e=a;f=b.Ha;g=b;h=d;q=!0;y=0;for(z=f.length;y<z;++y){w=e;m=f[y];H=g;u=h;switch(m.action){case "\u6d88\u9664":if("\u5f62\u72b6"==m.N)for(m=0,R=H.Y.length;m<R;++m)W=u.j.x+H.Y[m].Ba[0],L=u.j.y+H.Y[m].Ba[1],w.g[L][W]=null;else"\u4efb\u610f"==m.k?w.g[u.j.y][u.j.x]=null:"\u4efb\u610f2"==m.k&&(w.g[u.j.U][u.j.T]=null);break;case "\u521b\u5efa":if("\u5f62\u72b6"!=
m.N){W=u.j.x;L=u.j.y;H=[];if(-1!=m.k.indexOf("\u4efb\u610f")||-1!=m.k.indexOf("\u540c\u4e00"))for(R in R=void 0,w.A)w.A[R].getAttribute(m.N)==m.F&&H.push(R);else H.push(m.k);if("\u4efb\u610f2"==m.k||"\u540c\u4e002"==m.k)W=u.j.T,L=u.j.U;u=w.g[L];m=W;w=new pb(w.A[H[Math.floor(100*Math.random())%H.length]]);w.setAttribute(Z.P,W);w.setAttribute(Z.Q,L);u[m]=w}break;case "\u6539\u53d8\u5c5e\u6027":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?w.g[u.j.y][u.j.x].setAttribute(m.N,m.F):"\u4efb\u610f2"==m.k||"\u540c\u4e002"==
m.k?w.g[u.j.U][u.j.T].setAttribute(m.N,m.F):w.A[m.k].setAttribute(m.N,m.F);break;case "\u79fb\u52a8":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?$(w.g[u.j.y][u.j.x],w.g):"\u4efb\u610f2"!=m.k&&"\u540c\u4e002"!=m.k||$(w.g[u.j.U][u.j.T],w.g);break;case "\u5411\u4e0b\u79fb\u52a8":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?$(w.g[u.j.y][u.j.x],w.g,"\u4e0b"):"\u4efb\u610f2"!=m.k&&"\u540c\u4e002"!=m.k||$(w.g[u.j.U][u.j.T],w.g,"\u4e0b");break;case "\u5411\u4e0a\u79fb\u52a8":"\u4efb\u610f"==m.k||"\u540c\u4e00"==
m.k?$(w.g[u.j.y][u.j.x],w.g,"\u4e0a"):"\u4efb\u610f2"!=m.k&&"\u540c\u4e002"!=m.k||$(w.g[u.j.U][u.j.T],w.g,"\u4e0a");break;case "\u5411\u5de6\u79fb\u52a8":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?$(w.g[u.j.y][u.j.x],w.g,"\u5de6"):"\u4efb\u610f2"!=m.k&&"\u540c\u4e002"!=m.k||$(w.g[u.j.U][u.j.T],w.g,"\u5de6");break;case "\u5411\u53f3\u79fb\u52a8":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?$(w.g[u.j.y][u.j.x],w.g,"\u53f3"):"\u4efb\u610f2"!=m.k&&"\u540c\u4e002"!=m.k||$(w.g[u.j.U][u.j.T],w.g,"\u53f3");break;
case "\u6570\u503c\u589e\u52a0":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?qb(w.g[u.j.y][u.j.x],m.N,m.F):"\u4efb\u610f2"==m.k||"\u540c\u4e002"==m.k?qb(w.g[u.j.U][u.j.T],m.N,m.F):qb(w.A[m.k],m.N,m.F);break;case "\u6570\u503c\u51cf\u5c11":"\u4efb\u610f"==m.k||"\u540c\u4e00"==m.k?rb(w.g[u.j.y][u.j.x],m.N,m.F):"\u4efb\u610f2"==m.k||"\u540c\u4e002"==m.k?rb(w.g[u.j.U][u.j.T],m.N,m.F):rb(w.A[m.k],m.N,m.F);break;case "\u7ed3\u675f\u6e38\u620f":window.clearInterval(w.Qa);break;case "\u7ed3\u675f\u4e8b\u4ef6":u.I=
!1}if(!h.I){q=!1;break}}e={result:h,next:q,action:f}}else return[d.I,null]}while(e.next);return[d.I,e]}
function Cb(a,b,c,d,e){var f="\u6a2a\u5750\u6807"==b.N,g="\u7eb5\u5750\u6807"==b.N,h="\u6a2a\u5750\u6807"==b.F,l="\u7eb5\u5750\u6807"==b.F,q=""==b.Na;if(f||g){if(h||l){f&&h&&(c.T=c.x);f&&l&&(c.T=c.y);g&&h&&(c.U=c.x);g&&l&&(c.U=c.y);Db(d,e,!0);return}if(q){window.isNaN(parseInt(b.F))||(b.F=parseInt(b.F));g=!0;switch(b.hb){case "\u51cf\u53bb":d.H=(f?c.x:c.y)-b.F;break;case "\u52a0\u4e0a":d.H=(f?c.x:c.y)+b.F;break;case "\u4e58\u4ee5":d.H=(f?c.x:c.y)*b.F;break;case "\u9664\u4ee5":d.H=(f?c.x:c.y)/b.F;
break;default:g=!1}if(g){Db(d,e,!0);return}}}else if(h||l){h&&(c.T=d.H);l&&(c.U=d.H);Db(d,e,0<=c.T&&c.T<a.R[0]&&0<=c.U&&c.U<a.R[1]);return}f=Eb(a,b.k,b.N,d.H,c);a=Eb(a,b.Na,b.F,d.H,c);c=!1;g=0;window.isNaN(parseInt(f))||(f=parseInt(f));window.isNaN(parseInt(a))||(a=parseInt(a));switch(b.hb){case "\u5c0f\u4e8e":c=f<a;break;case "\u5927\u4e8e":c=f>a;break;case "\u7b49\u4e8e":c=f==a;break;case "\u4e0d\u7b49\u4e8e":c=f!=a;break;case "\u5927\u4e8e\u7b49\u4e8e":c=f>=a;break;case "\u5c0f\u4e8e\u7b49\u4e8e":c=
f<=a;break;case "\u51cf\u53bb":g=f-a;c=!0;break;case "\u52a0\u4e0a":g=f+a;c=!0;break;case "\u4e58\u4ee5":g=f*a;c=!0;break;case "\u9664\u4ee5":g=f/a;c=!0;break;default:c=!0}Db(d,e,c);d.H=g}function Db(a,b,c){switch(b){case "\u5e76\u4e14":a.I=a.I&&c;break;case "\u6216\u8005":a.I=a.I||c;break;case "\u5e76\u4e14\u4e0d\u662f":a.I=a.I&&!c;break;case "\u6216\u8005\u4e0d\u662f":a.I=a.I||!c;break;default:a.I=a.I||c}}
function Eb(a,b,c,d,e){var f=null;switch(b){case "\u7ed3\u679c":f=d;"\u7edd\u5bf9\u503c"==c&&0>f&&(f=-f);break;case "":f=c;break;default:-1==e.x?f=a.A[b]&&(f=a.A[b].getAttribute(c)):(f="\u4efb\u610f2"==b||"\u540c\u4e002"==b?a.g[e.U][e.T]:a.g[e.y][e.x],f=null==f||void 0==f?"\u4e0d\u5b58\u5728":""!=c?f.getAttribute(c):"\u5b58\u5728")}return f}
k.xa=function(){var a=this.C,b=800/this.R[0],c=600/this.R[1];a.clearRect(0,0,800,600);this.J&&a.drawImage(this.J,0,0,this.J.width,this.J.height);for(var d=0,e=this.g.length;d<e;++d)for(var f=0,g=this.g[d].length;f<g;++f){var h=this.g[d][f];if(h){var l=h.getAttribute(Z.P),q=h.getAttribute(Z.Q);(h=h.L.getData().src)&&a.drawImage(h,l*b,q*c,h.width,h.height)}}};function Fb(a,b,c,d){this.ma(a,b,c,d);this.bb();this.kb();this.Za();a=G("atd",this.d.ia);b=0;for(c=a.length;b<c;++b)if(a[b].Fb=b,!G("editbox",a[b]).length){var e=N(sb()),f=I("editboxinput",e),g=I("editboxselect",e);switch(b){case 0:f.value="\u65e0";var h=K("option");P(h,"\u65e0");g.appendChild(h);break;case 1:f.value="\u65e0";h=K("option");P(h,"\u65e0");g.appendChild(h);break;case 2:f.value="\u4e0a";var h=K("option"),l=K("option"),q=K("option"),y=K("option");P(h,"\u4e0a");P(l,"\u4e0b");P(q,"\u5de6");
P(y,"\u53f3");g.appendChild(h);g.appendChild(l);g.appendChild(q);g.appendChild(y);break;case 3:f.value="1";h=K("option");P(h,"1");g.appendChild(h);break;case 4:f.value="\u5426";h=K("option");l=K("option");P(h,"\u5426");P(l,"\u662f");g.appendChild(h);g.appendChild(l);break;case 5:f.value="\u65e0";h=K("option");P(h,"\u65e0");g.appendChild(h);break;case 6:f.value="\u65e0",h=K("option"),P(h,"\u65e0"),g.appendChild(h)}a[b].appendChild(e);Gb(this,g,f)}if(d){this.Xa=d.Ga.length;this.Ra=d.event.length;for(a=
0;a<d.Ga.length;++a)this.A[a]=new ob(d.Ga[a][0]),this.A[a].S=d.Ga[a][1],b=fb(d.Ga[a][0]).name,c=K("li"),P(c,b),D(c,"ch"),c.D=a,this.d.na.appendChild(c),X(c,"click",this.ta,!1,this);h=G("atd",this.d.ia);a=0;for(c=h.length;a<c;++a){l=I("editboxselect",h[a]);q=l.options.selectedIndex;for(e=l.options.length-1;0<=e;--e)O(l.options[e]);b=d.Pa[a].o;e=0;for(f=b.length;e<f;++e)g=K("option"),P(g,b[e]),l.appendChild(g);l.options.selectedIndex=q}for(a=h.length;a<d.Pa.length;++a){b={options:d.Pa[a].o,name:d.Pa[a].n};
c=K("li");f=K("p");D(c,"at");P(f,b.name);e=N(sb());D(f,"val");c.appendChild(f);c.appendChild(e);this.d.ia.appendChild(c);f=I("editboxinput",e);h=I("editboxselect",e);Gb(this,h,f);e=0;for(f=b.options.length;e<f;++e)g=K("option"),P(g,b.options[e]),h.appendChild(g);X(c,"click",this.nb,!1,this)}a=0;for(c=d.Ea.length;a<c;++a)b=d.Ea[a].x,e=d.Ea[a].y,f=d.Ea[a].l,g=d.Ea[a].a,this.g[e][b]=new pb(this.A[d.Ea[a].i]),this.g[e][b].V=f,this.g[e][b].$=g;this.q=d.event;for(a=0;a<this.q.length;++a)c=K("li"),b=ib(this.q[a]).name,
P(c,b),D(c,"me"),c.D=a,this.d.da.appendChild(c),X(c,"click",this.ta,!1,this);a=this.B;d=d.dc;a.ha=0;if(d)for(a.Ya=d.length,a.qa=d,b=0,c=d.length;b<c;++b)e=mb(d[b]),f=K("li"),P(f,e.name),D(f,"me"),f.D=b,a.d.oa.appendChild(f),X(f,"click",a.ta,!1,a)}}k=Fb.prototype;k.R=null;k.d=null;k.u=null;k.Z=null;k.A=null;k.K=null;k.Xa=null;k.la=null;k.J=null;k.ca=null;k.g=null;k.q=null;k.ja=null;k.Ra=null;k.B=null;k.Ja=null;
k.ma=function(a,b,c){a=parseInt(a);b=parseInt(b);"NaN"==a&&(a=20);"NaN"==b&&(b=15);this.Xa=this.ca=0;this.A=[];this.Ra=this.K=0;this.q=[];this.ja=0;this.R=[a,b];this.d={};this.la={};this.u=[];this.g=[];this.J=eb(c);this.B=new ub;this.Z=1};
k.bb=function(){this.d.C=p("canvas")?document.getElementById("canvas"):"canvas";this.d.u=N('\x3cdiv class\x3d"mapArea"\x3e\x3c/div\x3e');this.d.za=I("mapimgdiv");this.d.$=I("attribute");this.d.wa=I("chooseAction");this.d.ra=I("makeSure");this.d.W=I("cellName");this.d.aa=I("checkOption");this.d.Hb=G("cpt",this.d.aa);this.d.Aa=I("message");this.d.X=I("chooseType");this.d.ua=I("selectAttr");this.d.na=I("productlist");this.d.da=I("eventList");this.d.ia=I("attributeList");this.d.Ab=I("addCharacter");this.d.zb=
I("addAttribute");this.d.Eb=I("addWorld");this.d.Bb=I("addEvent");this.d.Db=I("addWorkflow");this.d.yb=I("addActionBtn");this.d.cc=I("saveGameData");this.d.Ob=I("downloaddata");this.d.oa=I("workflowList");this.d.Oa=I("workflowPart");this.d.Da=I("workflowspace");this.d.$b=I("runGame")};
k.kb=function(){for(var a=this.d,b=this,c=100/this.R[0]+"%",d=100/this.R[1]+"%",e=0;e<this.R[1];++e){this.u[e]=[];this.g[e]=[];for(var f=0;f<this.R[0];++f){var g=N('\x3cdiv class\x3d"mapBlock"\x3e\x3c/div\x3e');Y(g,"width",c);Y(g,"height",d);g.Ka=f;g.La=e;(function(a){X(a,"click",function(){if(5==b.Z&&b.d.Hb[3].checked)F(a,"selectedEffect")?E(a,"selectedEffect"):D(a,"selectedEffect");else if(F(a,"selected"))switch(E(a,"selected"),b.Z){case 1:0>=--b.ca&&(b.d.ra.style.display="none");break;case 3:b.g[a.La][a.Ka]=
null;Hb(b);break;case 5:F(a,"selectedNo")?(E(a,"selectedNo"),D(a,"selected"),D(a,"selectedHave")):F(a,"selectedHave")?(E(a,"selectedHave"),D(a,"selected"),D(a,"selectedNone")):F(a,"selectedNone")&&E(a,"selectedNone")}else switch(D(a,"selected"),b.Z){case 1:++b.ca;b.d.ra.style.display="inline-block";break;case 3:b.g[a.La][a.Ka]=new pb(b.A[b.K]);b.g[a.La][a.Ka].setAttribute(Z.P,a.Ka);b.g[a.La][a.Ka].setAttribute(Z.Q,a.La);Hb(b);break;case 5:D(a,"selectedNo")}})})(g);a.u.appendChild(g);this.u[e].push(g)}}a.za.appendChild(a.u);
a.Aa.style.display="block"};k.Za=function(){var a=this.d;X(a.u,"dragover",this.fb,!1,this);X(a.u,"drop",this.gb,!1,this);X(a.ra,"click",this.eb,!1,this);X(a.Ab,"click",this.Jb,!1,this);X(a.zb,"click",this.createAttribute,!1,this);X(a.Eb,"click",this.Qb,!1,this);X(a.Bb,"click",this.Pb,!1,this);X(a.yb,"click",this.xb,!1,this);X(a.Db,"click",this.Cb,!1,this);X(a.cc,"click",this.bc,!1,this);X(a.X,"change",this.ab,!1,this);X(a.$b,"click",this.Zb,!1,this)};
k.bc=function(){for(var a=[],b=0,c=this.A.length;b<c;++b)a.push([this.A[b].getData(),this.A[b].S]);for(var d=[],e=G("atd",this.d.ia),f=G("at",this.d.ia),b=0,c=e.length;b<c;++b){for(var g=I("editboxselect",e[b]),h=[],l=0,q=g.options.length;l<q;++l)h.push(Q(g.options[l]));d.push(gb(h,Q(e[b].childNodes[0])))}b=0;for(c=f.length;b<c;++b){g=I("editboxselect",f[b]);h=[];l=0;for(q=g.options.length;l<q;++l)h.push(Q(g.options[l]));d.push(gb(h,Q(f[b].childNodes[0])))}c=[];for(l=0;l<this.g.length;++l)for(b=0;b<
this.g[l].length;++b)(e=this.g[l][b])&&c.push(hb(b,l,e.V,e.$,fb(e.L.getData()).index));a={s:this.R,b:db(this.J),c:a,a:d,w:c,e:this.q,f:this.B.qa};this.Ja=new yb(this.R,this.A,this.J,this.g,this.q,this.B.qa,this.d.C.getContext("2d"));this.d.Ob.href="data:text/paint; utf-8,"+JSON.stringify(a)};
k.setData=function(a){var b=window.getComputedStyle(this.u[0][0]).width,c=window.getComputedStyle(this.u[0][0]).height,b=parseFloat(b.substr(b,b.length-2)),c=parseFloat(c.substr(c,c.length-2)),d=Ib(this);0<d.length?(a.P=d[0],a.Q=d[1],a.width=d[2],a.height=d[3]):(a.P=0,a.Q=0,a.width=0,a.height=0);a.P*=b;a.Q*=c;a.width*=b;a.height*=c;this.la.src=db(a);return a};
k.eb=function(){switch(this.Z){case 1:var a=this.la,b=Ib(this);this.la.P=b[0];this.la.Q=b[1];this.la.width=b[2];this.la.height=b[3];var c=""!=this.d.W.value?this.d.W.value:"\u7a7a";this.A[this.K]?(this.A[this.K].setData({w:a.width,h:a.height,s:a.src,x:a.P,y:a.Q,n:c,i:this.K}),a=G("ch",this.d.na),a=a[this.K],P(a,c)):(this.A[this.K]=new ob({w:a.width,h:a.height,s:a.src,x:a.P,y:a.Q,n:c,i:this.K}),a=K("li"),P(a,c),D(a,"ch"),a.D=this.K,this.d.na.appendChild(a),X(a,"click",this.ta,!1,this),++this.Xa);break;
case 2:var a=K("li"),d=K("p");D(a,"at");""!=this.d.W.value&&(P(d,this.d.W.value),b=N(sb()),D(d,"val"),a.appendChild(d),a.appendChild(b),this.d.ia.appendChild(a),d=I("editboxinput",b),b=I("editboxselect",b),Gb(this,b,d));X(a,"click",this.nb,!1,this);break;case 5:var a=[],b=[],d=[],e;e=G("cpt",this.d.aa)[0].checked;var c=G("cpt",this.d.aa)[1].checked,f=G("cpt",this.d.aa)[2].checked;e={r:e,t:c,s:f};for(var g=G("attr",this.d.ua),c=0,f=g.length;c<f;++c){var h=G("cellAttr",g[c])[0],l=I("operation",g[c]),
q=G("cellAttr",g[c])[1],y=I("logic",g[c]);a.push({fn:h.childNodes[0][h.childNodes[0].options.selectedIndex].value,fa:h.childNodes[1].childNodes[1].value,op:l.childNodes[0][l.childNodes[0].options.selectedIndex].value,sn:q.childNodes[0][q.childNodes[0].options.selectedIndex].value,sa:q.childNodes[1].childNodes[1].value,lo:y.childNodes[0][y.childNodes[0].options.selectedIndex].value})}g=G("ac",this.d.wa);c=0;for(f=g.length;c<f;++c)l=I("actionList",g[c]),h=G("cellAttr",g[c])[0],q=G("cellAttr",g[c])[1],
b.push({ac:l[l.options.selectedIndex].value,fn:h.childNodes[0][h.childNodes[0].options.selectedIndex].value,fa:h.childNodes[1].childNodes[1].value,sn:q.childNodes[0][q.childNodes[0].options.selectedIndex].value,sa:q.childNodes[1].childNodes[1].value});h=G("mapBlock",this.d.u);c=0;for(f=h.length;c<f;++c)q=Ea(h[c]),1<q.length&&d.push({p:c,s:q});c=""!=this.d.W.value?this.d.W.value:"\u7a7a";f=this.d.X.options.selectedIndex;-1!=f&&(f=this.d.X.options[f].value);this.q[this.ja]?(this.q[this.ja]={ej:a,ea:b,
em:d,mc:e,nm:c,ty:f},a=G("me",this.d.da),a=a[this.ja],P(a,c)):(this.q[this.ja]={ej:a,ea:b,em:d,mc:e,nm:c,ty:f},a=K("li"),P(a,c),D(a,"me"),a.D=this.ja,this.d.da.appendChild(a),X(a,"click",this.ta,!1,this),++this.Ra);this.ab();break;case 8:this.B.eb()}};
k.nb=function(a){a=a.M;for(a=a.target||a.srcElement;!F(a,"at");)a=a.parentNode;var b=this.A[this.K];if(F(a,"selected")){if(E(a,"selected"),b.S){var c=b.getAttribute(Z.G);c[Q(I("val",a))]=null;b.setAttribute(Z.G,c)}}else D(a,"selected"),b.S&&(c=b.getAttribute(Z.G),c[Q(I("val",a))]=0,b.setAttribute(Z.G,c))};
function Ib(a){for(var b=[],c=0,d=a.u.length;c<d;++c)for(var e=0,f=a.u[c].length;e<f;++e)F(a.u[c][e],"selected")&&b.push([c,e]);return 0<b.length?[b[0][1],b[0][0],b[b.length-1][1]-b[0][1]+1,b[b.length-1][0]-b[0][0]+1]:[]}
k.clear=function(){for(var a=0,b=this.u.length;a<b;++a)for(var c=0,d=this.u[a].length;c<d;++c)F(this.u[a][c],"selected")&&E(this.u[a][c],"selected"),F(this.u[a][c],"selectedNo")&&E(this.u[a][c],"selectedNo"),F(this.u[a][c],"selectedNone")&&E(this.u[a][c],"selectedNone"),F(this.u[a][c],"selectedHave")&&E(this.u[a][c],"selectedHave"),F(this.u[a][c],"selectedEffect")&&E(this.u[a][c],"selectedEffect");c=this.d.C.getContext("2d");c.clearRect(0,0,800,600);this.J&&c.drawImage(this.J,0,0,this.J.width,this.J.height);
this.d.W.value="";this.la=null;this.la={};G("cpt",this.d.aa)[0].checked=!1;G("cpt",this.d.aa)[1].checked=!1;G("cpt",this.d.aa)[2].checked=!1;a=G("ac",this.d.wa);for(c=a.length-1;0<=c;--c)O(a[c]);a=G("attr",this.d.ua);for(c=a.length-1;0<=c;--c)O(a[c]);Jb(this);this.ab();this.B.clear();this.Ja&&this.Ja.stop()};k.ab=function(){for(var a=G("me",this.d.da),b=0,c=this.q.length;b<c;++b){var d=ib(this.q[b]);d.type==this.d.X.options[this.d.X.options.selectedIndex].value?E(a[b],"hidden"):d.type&&D(a[b],"hidden")}};
function Kb(a){a.d.za.style.display="none";a.d.u.style.display="none";a.d.$.style.display="none";a.d.ra.style.display="none";a.d.wa.style.display="none";a.d.Aa.style.display="none";a.d.aa.style.display="none";a.d.X.style.display="none";a.d.na.style.display="none";a.d.da.style.display="none";a.d.ua.style.display="none";a.d.Oa.style.display="none";a.d.Da.style.display="none";a.d.oa.style.display="none";switch(a.Z){case 1:a.d.za.style.display="block";a.d.u.style.display="block";a.d.Aa.style.display=
"block";a.d.na.style.display="block";break;case 2:a.d.$.style.display="block";a.d.ra.style.display="inline-block";a.d.Aa.style.display="block";a.d.na.style.display="block";break;case 3:a.d.za.style.display="block";a.d.u.style.display="block";a.d.na.style.display="block";break;case 5:a.d.wa.style.display="block";a.d.ra.style.display="inline-block";a.d.Aa.style.display="block";a.d.da.style.display="block";a.d.ua.style.display="block";a.d.za.style.display="block";a.d.u.style.display="block";a.d.aa.style.display=
"block";a.d.X.style.display="inline-block";break;case 8:a.d.ra.style.display="inline-block";a.d.Aa.style.display="block";a.d.oa.style.display="block";a.d.X.style.display="inline-block";a.d.Oa.style.display="block";a.d.Da.style.display="block";break;case 13:a.d.za.style.display="block"}}k.Jb=function(){this.Z=1;Kb(this);this.clear();this.K=this.Xa};k.createAttribute=function(){this.Z=2;Kb(this);this.clear()};
k.Qb=function(){this.Z=3;Kb(this);this.clear();for(var a=G("mapBlock",this.d.u),b=0;b<this.g.length;++b)for(var c=0;c<this.g[b].length;++c)this.g[b][c]&&D(a[b*this.R[0]+c],"selected");Hb(this)};k.Pb=function(){this.Z=5;Kb(this);this.clear();this.ja=this.Ra};k.Cb=function(){this.Z=8;Kb(this);this.clear()};k.Zb=function(){this.Z=13;Kb(this);this.clear();this.Ja&&zb(this.Ja)};
function Lb(a){var b=N('\x3cdiv class\x3d"cellAttr"\x3e\x3cselect class\x3d"cellAttro"\x3e\x3coption\x3e\u4efb\u610f\x3c/option\x3e\x3coption\x3e\u4efb\u610f2\x3c/option\x3e\x3coption\x3e\u540c\u4e00\x3c/option\x3e\x3coption\x3e\u540c\u4e002\x3c/option\x3e\x3coption\x3e\u7ed3\u679c\x3c/option\x3e\x3coption\x3e\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e'),c=N('\x3cdiv class\x3d"editbox"\x3e\x3cselect class\x3d"editboxselect cellAttrv"\x3e\x3coption\x3e\u6a2a\u5750\u6807\x3c/option\x3e\x3coption\x3e\u7eb5\u5750\u6807\x3c/option\x3e\x3coption\x3e\u65b9\u5411\x3c/option\x3e\x3coption\x3e\u901f\u5ea6\x3c/option\x3e\x3coption\x3e\u53ef\u7a7f\u900f\x3c/option\x3e\x3coption\x3e\u72b6\u6001\x3c/option\x3e\x3coption\x3e\u5c5e\u4e8e\x3c/option\x3e\x3coption\x3e\u5f62\u72b6\x3c/option\x3e\x3coption\x3e\x3c/option\x3e\x3coption\x3e\u7edd\u5bf9\u503c\x3c/option\x3e\x3c/select\x3e\x3cinput type\x3d"text" class\x3d"editboxinput" /\x3e\x3c/div\x3e'),
d=I("editboxselect",c),e=I("editboxinput",c);b.appendChild(c);e.value="\u6a2a\u5750\u6807";X(d,"change",function(){var a=d.options.selectedIndex;0<=a&&(e.value=d.options[a].value)},!1,a);var f=I("cellAttro",b),g=I("cellAttrv",b);X(f,"mousedown",function(){Mb(a,f)},!1,a);X(g,"mousedown",function(){Nb(a,g)},!1,a);return b}
function Mb(a,b){for(var c=b.options.selectedIndex,d=G("new",b),e=d.length-1;0<=e;--e)F(d[e],"new")&&O(d[e]);for(var d=G("ch",a.d.na),e=0,f=d.length;e<f;++e){var g=K("option");D(g,"new");D(g,"judge");P(g,Q(d[e]));b.appendChild(g)}b.options.selectedIndex=c}
function Nb(a,b){for(var c=b.options.selectedIndex,d=G("new",b),e=d.length-1;0<=e;--e)F(d[e],"new")&&O(d[e]);for(var d=G("at",a.d.ia),e=0,f=d.length;e<f;++e){var g=K("option");D(g,"new");D(g,"judge");P(g,Q(I("val",d[e])));b.appendChild(g)}b.options.selectedIndex=c}
function Ob(a){var b=K("div");D(b,"ac");var c=K("p");P(c,"\u6267\u884c");var d=K("p");P(d,"\u4f5c\u7528\u4e8e");var e=N('\x3cselect class\x3d"actionList"\x3e\x3coption\x3e\u65e0\u4e8b\x3c/option\x3e\x3coption\x3e\u79fb\u52a8\x3c/option\x3e\x3coption\x3e\u5411\u4e0a\u79fb\u52a8\x3c/option\x3e\x3coption\x3e\u5411\u4e0b\u79fb\u52a8\x3c/option\x3e\x3coption\x3e\u5411\u5de6\u79fb\u52a8\x3c/option\x3e\x3coption\x3e\u5411\u53f3\u79fb\u52a8\x3c/option\x3e\x3coption\x3e\u521b\u5efa\x3c/option\x3e\x3coption\x3e\u6d88\u9664\x3c/option\x3e\x3coption\x3e\u4ea4\u6362\x3c/option\x3e\x3coption\x3e\u6570\u503c\u589e\u52a0\x3c/option\x3e\x3coption\x3e\u6570\u503c\u51cf\u5c11\x3c/option\x3e\x3coption\x3e\u6539\u53d8\u5c5e\u6027\x3c/option\x3e\x3coption\x3e\u7ed3\u675f\u6e38\u620f\x3c/option\x3e\x3coption\x3e\u5230\u8fbe\x3c/option\x3e\x3coption\x3e\u6267\u884c\x3c/option\x3e\x3coption\x3e\u7ed3\u675f\u4e8b\u4ef6\x3c/option\x3e\x3c/select\x3e'),f=
K("button");P(f,"\u5220\u9664");b.appendChild(c);b.appendChild(e);b.appendChild(d);Ha(b,Lb(a));Ha(b,Lb(a));b.appendChild(f);a.d.wa.appendChild(b);for(var c=e.options.selectedIndex,d=G("me",a.d.da),g=e.options.length-1;0<=g;--g)F(e.options[g],"new")&&O(e.options[g]);for(var g=0,h=d.length;g<h;++g){var l=K("option");D(l,"new");D(l,"judge");P(l,Q(d[g]));e.appendChild(l)}e.options.selectedIndex=c;X(f,"click",function(){O(b)},!1,a);X(e,"mousedown",function(){for(var b=G("me",a.d.da),c=e.options.selectedIndex,
d=e.options.length-1;0<=d;--d)F(e.options[d],"new")&&O(e.options[d]);for(var d=0,f=b.length;d<f;++d){var g=K("option");D(g,"new");D(g,"judge");P(g,Q(b[d]));e.appendChild(g)}e.options.selectedIndex=c},!1,a)}
function Jb(a){var b=K("div");D(b,"attr");var c=N('\x3cdiv class\x3d"operation"\x3e\x3cselect\x3e\x3coption\x3e\u65e0\x3c/option\x3e\x3coption\x3e\u5927\u4e8e\x3c/option\x3e\x3coption\x3e\u5c0f\u4e8e\x3c/option\x3e\x3coption\x3e\u7b49\u4e8e\x3c/option\x3e\x3coption\x3e\u4e0d\u7b49\u4e8e\x3c/option\x3e\x3coption\x3e\u5927\u4e8e\u7b49\u4e8e\x3c/option\x3e\x3coption\x3e\u5c0f\u4e8e\u7b49\u4e8e\x3c/option\x3e\x3coption\x3e\u51cf\u53bb\x3c/option\x3e\x3coption\x3e\u52a0\u4e0a\x3c/option\x3e\x3coption\x3e\u4e58\u4ee5\x3c/option\x3e\x3coption\x3e\u9664\u4ee5\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e');N(sb());
var d=N('\x3cdiv class\x3d"logic"\x3e\x3cselect\x3e\x3coption\x3e\u65e0\x3c/option\x3e\x3coption\x3e\u5e76\u4e14\x3c/option\x3e\x3coption\x3e\u6216\u8005\x3c/option\x3e\x3coption\x3e\u5e76\u4e14\u4e0d\u662f\x3c/option\x3e\x3coption\x3e\u6216\u8005\u4e0d\u662f\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e');Ha(b,Lb(a));b.appendChild(c);Ha(b,Lb(a));b.appendChild(d);a.d.ua.appendChild(b);var e=null;X(d,"change",function(){if(0==d.childNodes[0].options.selectedIndex){e&&O(e)&&(e=null);for(var c=G("attr",
a.d.ua),g=c.length-1;0<g&&c[g]!=b;--g)O(c[g])}else e||(e=Jb(a))},!1,a);return b}
function Hb(a){var b=window.getComputedStyle(a.u[0][0]).width,c=window.getComputedStyle(a.u[0][0]).height,b=parseFloat(b.substr(b,b.length-2)),c=parseFloat(c.substr(c,c.length-2)),d=a.d.C.getContext("2d");d.clearRect(0,0,800,600);a.J&&d.drawImage(a.J,0,0,a.J.width,a.J.height);for(var e=0;e<a.g.length;++e)for(var f=0;f<a.g[e].length;++f)if(a.g[e][f]){var g=a.g[e][f].getAttribute(Z.P),h=a.g[e][f].getAttribute(Z.Q),l=fb(a.g[e][f].L.getData());l.src=eb(l.src);l.src&&d.drawImage(l.src,g*b,h*c,l.src.width,
l.src.height)}}k.xb=function(){Ob(this)};function Gb(a,b,c){X(b,"change",function(){var d=b.options.selectedIndex;0<=d&&(c.value=b.options[d].value);Pb(a,c)},!1,a);X(b,"mousedown",function(){for(var a=1,e=0,f=b.options.length;e<f;++e)if(c.value==b.options[e].value){a=0;break}a&&(a=K("option"),P(a,c.value),b.appendChild(a))},!1,a);X(c,"change",function(){Pb(a,c)},!1,a)}
function Pb(a,b){for(var c=b;!F(c,"at")&&!F(c,"atd");)c=c.parentNode;var d=a.A[a.K];if(F(c,"atd"))switch(c.Fb){case 0:d.setAttribute(Z.P,b.value);break;case 1:d.setAttribute(Z.Q,b.value);break;case 2:d.setAttribute(Z.dir,b.value);break;case 3:d.setAttribute(Z.speed,b.value);break;case 4:d.setAttribute(Z.wb,b.value);break;case 5:d.setAttribute(Z.status,b.value);break;case 6:d.setAttribute(Z.mb,b.value)}else{var e=d.getAttribute(Z.G);e[Q(I("val",c))]=b.value;d.setAttribute(Z.G,e)}}
k.ta=function(a){a=a.M;a=a.target||a.srcElement;switch(this.Z){case 1:this.clear();this.K=a.D;var b=fb(this.A[this.K].getData());a=this.u[b.jb+b.height-1][b.ib+b.width-1];D(this.u[b.jb][b.ib],"selected");D(a,"selected");a=this.d.C.getContext("2d");var c=window.getComputedStyle(this.u[0][0]).width,d=window.getComputedStyle(this.u[0][0]).height,c=parseFloat(c.substr(c,c.length-2)),d=parseFloat(d.substr(d,d.length-2));b.src=eb(b.src);b.src&&a.drawImage(b.src,b.ib*c,b.jb*d,b.src.width,b.src.height);this.d.W.value=
b.name;break;case 2:this.K=a.D;b=this.A[this.K].S;null==b&&(this.A[this.K].S={posX:"\u65e0",posY:"\u65e0",dir:"\u4e0a",speed:"1",visiable:"\u5426",status:"\u65e0",belong:"\u65e0",others:{}});var b=this.A[this.K].S,d=this.A[this.K].getAttribute(Z.G),e=G("at",this.d.ia);a=0;for(c=e.length;a<c;++a)E(e[a],"selected"),void 0!=d[Q(I("val",e[a]))]&&null!=d[Q(I("val",e[a]))]&&D(e[a],"selected");var f=[Z.P,Z.Q,Z.dir,Z.speed,Z.wb,Z.status,Z.mb,Z.G],g=G("atd",this.d.ia);a=0;for(c=g.length;a<c;++a)I("editboxinput",
g[a]).value=b[f[a]],I("editboxselect",g[a]).options.selectedIndex=-1;a=0;for(c=e.length;a<c;++a)b=d[Q(I("val",e[a]))],void 0!=b&&null!=b?I("editboxinput",e[a]).value=b:I("editboxinput",e[a]).value="";break;case 3:this.K=a.D;break;case 5:this.clear();this.ja=a.D;b=ib(this.q[this.ja]);d=b.Ia;e=b.Ha;f=b.Y;a=lb(b.Sa);this.ka(this.d.X,b.type);this.d.W.value=b.name;G("cpt",this.d.aa)[0].checked=a.rotate||"true"==a.rotate;G("cpt",this.d.aa)[1].checked=a.vb||"true"==a.vb;G("cpt",this.d.aa)[2].checked=a.lb||
"true"==a.lb;b=G("mapBlock",this.d.u);a=0;for(c=f.length;a<c;++a)for(var g=f[a].p,h=f[a].s,l=0;l<h.length;++l)D(b[g],h[l]);a=0;for(c=e.length;a<c;++a)Ob(this),g=kb(e[a]),f=G("ac",this.d.wa),h=I("actionList",f[a]),b=G("cellAttr",f[a])[0],f=G("cellAttr",f[a])[1],this.ka(h,g.action),Qb(this,b,g.k,g.N),Qb(this,f,g.Na,g.F);a=0;for(c=d.length;a<c;++a)0<a&&Jb(this),e=jb(d[a]),h=G("attr",this.d.ua),b=G("cellAttr",h[a])[0],g=I("operation",h[a]),f=G("cellAttr",h[a])[1],h=I("logic",h[a]),Qb(this,b,e.k,e.N),
Qb(this,f,e.Na,e.F),this.ka(g.childNodes[0],e.hb),this.ka(h.childNodes[0],e.Ta)}};function Qb(a,b,c,d){var e=I("cellAttro",b);b=I("cellAttrv",b);Mb(a,e);Nb(a,b);null!=c&&a.ka(e,c);null!=d&&(a.ka(b,d),b.parentNode.childNodes[1].value=d)}k.ka=function(a,b){for(var c=0,d=a.options.length;c<d;++c)if(a.options[c].value==b){a.options.selectedIndex=c;break}};k.fb=function(a){a=a.M;a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"};
k.gb=function(a){function b(a){var b=new Image;b.onload=c;b.src=a.target.result}function c(a){a=a.target||a.srcElement;a=d.setData(a);800!=e.C.width&&(e.C.width=800,e.C.height=600);e.C.getContext("2d").drawImage(a,a.P,a.Q,a.width,a.height)}a=a.M;var d=this,e=this.d;a.stopPropagation();a.preventDefault();a=(a.dataTransfer||a.target).files[0];if(/image/.test(a.type)){var f=new FileReader;f.onload=b;f.readAsDataURL(a)}else alert("That's not an image file!")};function Rb(){X(window,"load",this.ma,!1,this)}k=Rb.prototype;k.d=null;k.J=null;k.L=null;k.ma=function(){this.d={};this.bb();this.kb();this.Za()};k.bb=function(){this.d.Nb=p("defsize")?document.getElementById("defsize"):"defsize";this.d.C=p("canvas")?document.getElementById("canvas"):"canvas";this.d.Lb=G("defsize")[0];this.d.Mb=G("defsize")[1];this.d.sb=I("size");this.d.pb=I("mapimgdiv");this.d.ba=I("mapimg");this.d.Ua=G("menulist");this.d.Tb=I("loadData")};
k.Za=function(){var a=this.d;X(a.Nb,"click",this.Kb,!1,this);X(a.pb,"dragover",this.fb,!1,this);X(a.pb,"drop",this.gb,!1,this);X(a.Tb,"change",this.Sb,!1,this)};k.kb=function(){};k.Kb=function(){var a=this.d;Y(a.Ua[0],"display","none");Y(a.sb,"display","none");Y(a.ba,"display","none");Y(a.C,"display","block");Y(a.Ua[1],"display","block");new Fb(a.Lb.value,a.Mb.value,this.J)};k.fb=function(a){a=a.M;a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"};
k.gb=function(a){function b(a){var b=new Image;b.onload=c;b.src=a.target.result}function c(a){a=a.target||a.srcElement;e.ba.width=800;e.ba.src=a.src;e.ba.height=e.ba.height;e.ba.width=e.ba.width;e.C.width=800;e.C.height=600;d.J=db(e.ba);a=e.C.getContext("2d");a.clearRect(0,0,800,600);a.drawImage(e.ba,0,0,e.ba.width,e.ba.height)}a=a.M;var d=this,e=this.d;a.stopPropagation();a.preventDefault();a=(a.dataTransfer||a.target).files[0];if(/image/.test(a.type)){var f=new FileReader;f.onload=b;f.readAsDataURL(a)}else alert("That's not an image file!")};
k.Ub=function(a){a=a.M;a=JSON.parse(a.target.result);this.L={size:a.s,background:a.b,Ga:a.c,Pa:a.a,Ea:a.w,event:a.e,dc:a.f};a=this.d;a.C.width=800;a.C.height=600;Y(a.Ua[0],"display","none");Y(a.sb,"display","none");Y(a.ba,"display","none");Y(a.C,"display","block");Y(a.Ua[1],"display","block");new Fb(this.L.size[0],this.L.size[1],this.L.background,this.L)};k.Sb=function(a){a=a.M;a=a.target.files;if(a[0]){var b=new FileReader;X(b,"load",this.Ub,!1,this);b.readAsText(a[0])}};new Rb;})();