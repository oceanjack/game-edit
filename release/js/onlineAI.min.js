(function(){var h,m=this;
function q(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function s(a){return"string"==typeof a}var t="closure_uid_"+(1E9*Math.random()>>>0),u=0;function aa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};function ba(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function ca(a){var b=s(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,d){return b+d.toUpperCase()})};var v=Array.prototype,w=v.indexOf?function(a,b,c){return v.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(s(a))return s(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function x(a,b){var c=w(a,b);0<=c&&v.splice.call(a,c,1)};var y,z,A,B;function C(){return m.navigator?m.navigator.userAgent:null}B=A=z=y=!1;var D;if(D=C()){var da=m.navigator;y=0==D.lastIndexOf("Opera",0);z=!y&&(-1!=D.indexOf("MSIE")||-1!=D.indexOf("Trident"));A=!y&&-1!=D.indexOf("WebKit");B=!y&&!A&&!z&&"Gecko"==da.product}var E=y,F=z,G=B,H=A,I=m.navigator,ea=-1!=(I&&I.platform||"").indexOf("Mac");function J(){var a=m.document;return a?a.documentMode:void 0}var K;
a:{var L="",M;if(E&&m.opera)var N=m.opera.version,L="function"==typeof N?N():N;else if(G?M=/rv\:([^\);]+)(\)|;)/:F?M=/\b(?:MSIE|rv)\s+([^\);]+)(\)|;)/:H&&(M=/WebKit\/(\S+)/),M)var O=M.exec(C()),L=O?O[1]:"";if(F){var fa=J();if(fa>parseFloat(L)){K=String(fa);break a}}K=L}var ga={};
function P(a){var b;if(!(b=ga[a])){b=0;for(var c=String(K).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=Math.max(c.length,e.length),f=0;0==b&&f<d;f++){var g=c[f]||"",k=e[f]||"",p=RegExp("(\\d*)(\\D*)","g"),r=RegExp("(\\d*)(\\D*)","g");do{var n=p.exec(g)||["","",""],l=r.exec(k)||["","",""];if(0==n[0].length&&0==l[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==n[1].length?0:parseInt(n[1],
10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==n[2].length)<(0==l[2].length)?-1:(0==n[2].length)>(0==l[2].length)?1:0)||(n[2]<l[2]?-1:n[2]>l[2]?1:0)}while(0==b)}b=ga[a]=0<=b}return b}var ha=m.document,ia=ha&&F?J()||("CSS1Compat"==ha.compatMode?parseInt(K,10):5):void 0;!G&&!F||F&&F&&9<=ia||G&&P("1.9.1");F&&P("9");function Q(a,b){var c=b||document;return c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):ja(a,b)}function R(a){var b=document,c=null;return(c=b.querySelectorAll&&b.querySelector?b.querySelector("."+a):Q(a,void 0)[0])||null}
function ja(a,b){var c,e,d,f;c=document;c=b||c;if(c.querySelectorAll&&c.querySelector&&a)return c.querySelectorAll(""+(a?"."+a:""));if(a&&c.getElementsByClassName){var g=c.getElementsByClassName(a);return g}g=c.getElementsByTagName("*");if(a){f={};for(e=d=0;c=g[e];e++){var k=c.className;"function"==typeof k.split&&0<=w(k.split(/\s+/),a)&&(f[d++]=c)}f.length=d;return f}return g}
function ka(a){var b=document,c=b.createElement("div");F?(c.innerHTML="\x3cbr\x3e"+a,c.removeChild(c.firstChild)):c.innerHTML=a;if(1==c.childNodes.length)return c.removeChild(c.firstChild);for(a=b.createDocumentFragment();c.firstChild;)a.appendChild(c.firstChild);return a};var la=!F||F&&9<=ia,ma=F&&!P("9");!H||P("528");G&&P("1.9b")||F&&P("8")||E&&P("9.5")||H&&P("528");G&&!P("8")||F&&P("9");function S(a,b){this.type=a;this.currentTarget=this.target=b}h=S.prototype;h.j=!1;h.defaultPrevented=!1;h.G=!0;h.stopPropagation=function(){this.j=!0};h.preventDefault=function(){this.defaultPrevented=!0;this.G=!1};function T(a){T[" "](a);return a}T[" "]=function(){};function U(a,b){a&&this.d(a,b)}(function(){function a(){}a.prototype=S.prototype;U.t=S.prototype;U.prototype=new a})();h=U.prototype;h.target=null;h.relatedTarget=null;h.offsetX=0;h.offsetY=0;h.clientX=0;h.clientY=0;h.screenX=0;h.screenY=0;h.button=0;h.keyCode=0;h.charCode=0;h.ctrlKey=!1;h.altKey=!1;h.shiftKey=!1;h.metaKey=!1;h.F=!1;h.c=null;
h.d=function(a,b){var c=this.type=a.type;S.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var e=a.relatedTarget;if(e){if(G){var d;a:{try{T(e.nodeName);d=!0;break a}catch(f){}d=!1}d||(e=null)}}else"mouseover"==c?e=a.fromElement:"mouseout"==c&&(e=a.toElement);this.relatedTarget=e;this.offsetX=H||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=H||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:
a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.F=ea?a.metaKey:a.ctrlKey;this.state=a.state;this.c=a;a.defaultPrevented&&this.preventDefault();delete this.j};h.stopPropagation=function(){U.t.stopPropagation.call(this);this.c.stopPropagation?this.c.stopPropagation():this.c.cancelBubble=!0};
h.preventDefault=function(){U.t.preventDefault.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ma)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var na="closure_listenable_"+(1E6*Math.random()|0),oa=0;function pa(a,b,c,e,d,f){this.e=a;this.s=b;this.src=c;this.type=e;this.capture=!!d;this.n=f;this.key=++oa;this.h=this.l=!1};var qa={},V={},W={},X={};
function Y(a,b,c,e,d){if("array"==q(b))for(var f=0;f<b.length;f++)Y(a,b[f],c,e,d);else if(c=ra(c),a&&a[na])a.I(b,c,e,d);else a:{if(!b)throw Error("Invalid event type");e=!!e;var g=V;b in g||(g[b]={b:0});g=g[b];e in g||(g[e]={b:0},g.b++);var g=g[e],f=a[t]||(a[t]=++u),k;if(g[f]){k=g[f];for(var p=0;p<k.length;p++)if(g=k[p],g.e==c&&g.n==d){if(g.h)break;k[p].l=!1;break a}}else k=g[f]=[],g.b++;p=sa();g=new pa(c,p,a,b,e,d);g.l=!1;p.src=a;p.e=g;k.push(g);W[f]||(W[f]=[]);W[f].push(g);a.addEventListener?a.addEventListener(b,
p,e):a.attachEvent(b in X?X[b]:X[b]="on"+b,p);qa[g.key]=g}}function sa(){var a=ta,b=la?function(c){return a.call(b.src,b.e,c)}:function(c){c=a.call(b.src,b.e,c);if(!c)return c};return b}function ua(a,b,c){var e=1;b=b[t]||(b[t]=++u);if(a[b]){a=a[b];b=a.length;if(0<b){for(var d=Array(b),f=0;f<b;f++)d[f]=a[f];a=d}else a=[];for(b=0;b<a.length;b++)(d=a[b])&&!d.h&&(e&=!1!==Z(d,c))}return Boolean(e)}
function Z(a,b){var c=a.e,e=a.n||a.src;if(a.l&&"number"!=typeof a&&a&&!a.h){var d=a.src;if(d&&d[na])d.J(a);else{var f=a.type,g=a.s,k=a.capture;d.removeEventListener?d.removeEventListener(f,g,k):d.detachEvent&&d.detachEvent(f in X?X[f]:X[f]="on"+f,g);d=d[t]||(d[t]=++u);W[d]&&(g=W[d],x(g,a),0==g.length&&delete W[d]);a.h=!0;a.e=null;a.s=null;a.src=null;a.n=null;if(g=V[f][k][d])x(g,a),0==g.length&&(delete V[f][k][d],V[f][k].b--),0==V[f][k].b&&(delete V[f][k],V[f].b--),0==V[f].b&&delete V[f];delete qa[a.key]}}return c.call(e,
b)}
function ta(a,b){if(a.h)return!0;var c=a.type,e=V;if(!(c in e))return!0;var e=e[c],d,f;if(!la){if(!(c=b))a:{for(var c=["window","event"],g=m;d=c.shift();)if(null!=g[d])g=g[d];else{c=null;break a}c=g}d=c;c=!0 in e;g=!1 in e;if(c){if(0>d.keyCode||void 0!=d.returnValue)return!0;a:{var k=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(p){k=!0}if(k||void 0==d.returnValue)d.returnValue=!0}}k=new U;k.d(d,this);d=!0;try{if(c){for(var r=[],n=k.currentTarget;n;n=n.parentNode)r.push(n);f=e[!0];for(var l=r.length-
1;!k.j&&0<=l;l--)k.currentTarget=r[l],d&=ua(f,r[l],k);if(g)for(f=e[!1],l=0;!k.j&&l<r.length;l++)k.currentTarget=r[l],d&=ua(f,r[l],k)}else d=Z(a,k)}finally{r&&(r.length=0)}return d}e=new U(b,this);return d=Z(a,e)}var va="__closure_events_fn_"+(1E9*Math.random()>>>0);function ra(a){return"function"==q(a)?a:a[va]||(a[va]=function(b){return a.handleEvent(b)})};function $(a,b,c){if(s(b))wa(a,c,b);else{a=aa(wa,a);for(var e in b)a.call(void 0,b[e],e,b)}}function wa(a,b,c){var e;a:if(e=ba(c),void 0===a.style[e]&&(c=(H?"Webkit":G?"Moz":F?"ms":E?"O":null)+ca(c),void 0!==a.style[c])){e=c;break a}e&&(a.style[e]=b)};F&&P(8);function xa(a,b){this.d(a,b);this.m();this.p();this.k()}h=xa.prototype;h.i=null;h.a=null;h.d=function(a,b){a=parseInt(a);b=parseInt(b);"NaN"==a&&(a=20);"NaN"==b&&(b=15);this.i=[a,b];this.a={}};h.m=function(){this.a.f=s("canvas")?document.getElementById("canvas"):"canvas";this.a.q=ka('\x3cdiv class\x3d"mapArea"\x3e\x3c/div\x3e');this.a.B=R("editarea")};
h.p=function(){for(var a=this.a,b=100/this.i[0]+"%",c=100/this.i[1]+"%",e=0;e<this.i[1];++e)for(var d=0;d<this.i[0];++d){var f=ka('\x3cdiv class\x3d"mapBlock"\x3e\x3c/div\x3e');$(f,"width",b);$(f,"height",c);a.q.appendChild(f)}a.B.appendChild(a.q)};h.k=function(){};function ya(){Y(window,"load",this.d,!1,this)}h=ya.prototype;h.a=null;h.d=function(){this.a={};this.m();this.p();this.k()};h.m=function(){this.a.A=s("defsize")?document.getElementById("defsize"):"defsize";this.a.f=s("canvas")?document.getElementById("canvas"):"canvas";this.a.v=Q("defsize")[0];this.a.w=Q("defsize")[1];this.a.H=R("size");this.a.o=R("mapimgdiv");this.a.g=R("mapimg");this.a.r=Q("menulist")};
h.k=function(){var a=this.a;Y(a.A,"click",this.u,!1,this);Y(a.o,"dragover",this.C,!1,this);Y(a.o,"drop",this.D,!1,this)};h.p=function(){};h.u=function(){var a=this.a;$(a.r[0],"display","none");$(a.H,"display","none");$(a.o,"display","none");$(a.f,"display","block");$(a.r[1],"display","block");new xa(a.v.value,a.w.value)};h.C=function(a){a=a.c;a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"};
h.D=function(a){function b(a){var b=new Image;b.onload=c;b.src=a.target.result}function c(a){a=a.target||a.srcElement;e.g.width=600;e.g.src=a.src;e.f.width=600;e.f.height=800;a=e.f.getContext("2d");a.clearRect(0,0,600,800);a.drawImage(e.g,0,0,e.g.width,e.g.height)}a=a.c;var e=this.a;a.stopPropagation();a.preventDefault();a=(a.dataTransfer||a.target).files[0];if(/image/.test(a.type)){var d=new FileReader;d.onload=b;d.readAsDataURL(a)}else alert("That's not an image file!")};new ya;})();